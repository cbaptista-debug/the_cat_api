####Case API - TheCatApi

### Author

Caique Vicente Baptista

### Dependencys

Apache TomCat 9
Zabbix-agent
Splunf-Forwarder
MySql Server



### Documentation

Apache TomCat 9 please visit: ("https://tomcat.apache.org/tomcat-9.0-doc/index.html")
Zabbix-agent please visit: ("https://www.zabbix.com/documentation/3.4/en/manual/concepts/agent")
Splunk-Forwarder please visit: ("https://docs.splunk.com/Documentation")
Mysql-Server please visit: ("https://dev.mysql.com/doc/")


### Project Documentation 

The project documentation was generated by javadoc and can be found in documentantion directory on this repository 

### Security

All the usernames and passwords are used and created by own user.

### Description Project

This project collect some informations from the API: https://thecatapi.com/


### How to ..

First, it is necessary to install the desired TomCat version, in this project I used version 9 for greater compatibility.

After installation, just copy the file "Trabalho.war" into Tomcat's WebApps folder.

Initiate tomcat as well as catalina.

### Perform the installation of Splunk-Forwarder through the organization's website.


2. Install Splunk

sudo dpkg -i splunk-7.1.1-8f0ead9ec3db-linux-2.6-amd64.deb
3. Enable the Splunk to start at boot

sudo / opt / splunk / bin / splunk enable boot-start
4. Start the Splunk service

sudo service splunk start
After running commands above, you have to accept the license agreement by typing “y”
Then, You’ll then be prompted to create an initial admin password. Use this password to access the web portal
5. Start the Splunk service

sudo service splunk start
6. Splunk will be started at port 8000. You can access the application via URL http: // localhost: 8000 (Change localhost with public IP address of the system.)

font: "https://tudip.com/blog-post/install-splunk-on-ubuntu/"

After the install we need to login Splunk and import our JSon Script, after that we have to use the following query : source="TRABALHO.postman_collection_json" host="caique" sourcetype="_json" . 

### Perform the installation of Prometheus . 

 mkdir /etc/prometheus

mkdir /var/lib/prometheus

useradd --no-create-home --shell /bin/false prometheus

useradd --no-create-home --shell /bin/false node_exporter

Download the repository of prometheus

tar xvf <repository-name>

cp <repository-name>/prometheus /usr/local/bin/

cp <repository-name>/promtool /usr/local/bin/



cp -r <repository-name>/consoles /etc/prometheus

cp -r <repository-name>/console_libraries /etc/prometheus

rm -rf <repository-name>.tar.gz 

# vim /etc/prometheus/prometheus.yml

global:
  scrape_interval:    10s
  evaluation_interval: 20s
rule_files:
 - 'alert.rules'
scrape_configs:
  - job_name: 'prometheus'
    scrape_interval: 5s
    static_configs:
         - targets: ['localhost:9090']

# vim /etc/prometheus/alert.rules
-------------------------------------------------------
groups:
- name: example
  rules:
  Alert for any instance that is unreachable for >5 minutes.
  - alert: service_down
    expr: up == 0
    for: 2m
    labels:
      severity: page
    annotations:
      summary: "Instance {{ $labels.instance }} down"
      description: "{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 2 minutes."
 
  - alert: high_load
    expr: node_load1 > 0.5
    for: 2m
    labels:
      severity: page
    annotations:
      summary: "Instance {{ $labels.instance }} under high load"
      description: "{{ $labels.instance }} of job {{ $labels.job }} is under high load."
---------------------------------------------------------------------------
chown prometheus:prometheus /usr/local/bin/prometheus

chown prometheus:prometheus /usr/local/bin/promtool

chown -R prometheus:prometheus /etc/prometheus

chown -R prometheus:prometheus /var/lib/prometheus
---------------------------------------------------------------
vim /etc/systemd/system/prometheus.service

[Unit]
Description=Prometheus
Wants=network-online.target
After=network-online.target
 
[Service]
User=prometheus
Group=prometheus
Type=simple
ExecStart=/usr/local/bin/prometheus \
    --config.file /etc/prometheus/prometheus.yml \
    --storage.tsdb.path /var/lib/prometheus/ \
    --web.console.templates=/etc/prometheus/consoles \
    --web.console.libraries=/etc/prometheus/console_libraries
 
[Install]
WantedBy=multi-user.target
-----------------------------------------------------------
systemctl daemon-reload

systemctl start prometheus

systemctl status prometheus

 netstat -atunp | grep 9090   


### Manual 

All the pictures with log's and dashboards you can find at images directory on this repository . 

Thanks to all i hope you enjoy and i appreciated the opportunity 